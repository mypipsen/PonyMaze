(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{189:function(e,t,n){e.exports=n(419)},194:function(e,t,n){},216:function(e,t,n){(function(e){e.Array.range=function(e){return Array.apply(null,Array(e)).map(function(e,t){return t})},e.Object.defineProperty(Array.prototype,"chunk",{value:function(e){var t=this;return Array.range(Math.ceil(this.length/e)).map(function(n,a){return t.slice(a*e,a*e+e)})}})}).call(this,n(72))},419:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(88),c=n.n(o),i=(n(194),n(26)),u=n(27),s=n(31),l=n(28),m=n(30),p=n(29),d=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.error;return e?r.a.createElement("div",{className:"notification toast show"},r.a.createElement("div",{className:"toast-header text-center m-0 p-0"},r.a.createElement("div",{className:"alert m-0 ".concat(this.className)},e))):null}},{key:"className",get:function(){return"You won. Game ended"===this.props.error?"alert-success":"alert-danger"}}]),t}(a.Component),f=Object(p.b)(function(e){return{error:e.error}})(d),h={set:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",r=new Date;r.setDate(r.getDate()+n),document.cookie="".concat(e,"=").concat(t,"; expires=").concat(r.toString(),";path=").concat(a)},get:function(e){for(var t,n,a=document.cookie.split(";"),r=0,o=a.length;r<o;r++)if(t=a[r].substr(0,a[r].indexOf("=")).replace(/^\s+|\s+$/g,""),n=a[r].substr(a[r].indexOf("=")+1),t===e)return decodeURI(n)}},y=n(90),v=n.n(y),b="https://ponychallenge.trustpilot.com/pony-challenge",O={create:function(e){return new Promise(function(t,n){v.a.post("".concat(b,"/maze"),e).then(function(e){t(e.data.maze_id)}).catch(function(e){return n(e)})})},fetch:function(e){return new Promise(function(t,n){v.a.get("".concat(b,"/maze/").concat(e)).then(function(e){return t(e.data)}).catch(function(e){return n(e)})})},move:function(e,t){return new Promise(function(n,a){v.a.post("".concat(b,"/maze/").concat(e),{direction:t}).then(function(e){200===e.status&&"Move accepted"===e.data["state-result"]?n(e.data):a({response:{data:e.data["state-result"]}})}).catch(function(e){return a(e)})})}},E={search:function(e){return new Promise(function(t,n){var a=e.size[0],r=e.size[1],o=e.data,c=e["end-point"][0],i=e.pony[0],u={},s=[],l=function(e){return"undefined"!==typeof u[e]},m=function(e,t){switch(e){case"east":return t.x===a-1;case"west":return 0===t.x;case"north":return 0===t.y;case"south":return t.y===r-1;default:return!1}};!function e(r){var i=o[r],p={x:r%a,y:Math.floor(r/a)};if(r===c)return t(s);u[r]=r,s.push(r);var d=r+1,f=r-1,h=r-a,y=r+a;if(!l(d)&&!m("east",p)&&-1===o[d].indexOf("west"))return e(d);if(!l(f)&&!m("west",p)&&-1===i.indexOf("west"))return e(f);if(!l(h)&&!m("north",p)&&-1===i.indexOf("north"))return e(h);if(!l(y)&&!m("south",p)&&-1===o[y].indexOf("north"))return e(y);s.pop();var v=s.pop();if(v)return e(v);n("Failed solving maze")}(i)})}},z="FETCH_MAZES",j="FETCH_MAZE_SUCCESS",w="FETCH_MAZE_FAILURE",k="CREATE_MAZE_SUCCESS",g="CREATE_MAZE_FAILURE",N="MOVE_SUCCESS",_="MOVE_FAILURE",C="SOLUTION_SUCCESS",S="SOLUTION_FAILURE";function M(){var e=h.get("mazes");if("undefined"===typeof e)return[];try{return e=JSON.parse(e),Array.isArray(e)?e:[]}catch(t){return[]}}function A(e){return function(t){O.fetch(e).then(function(e){t({type:j,payload:e})}).catch(function(e){t({type:w,payload:e.response.data})})}}var x=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={active:!1},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchMazes()}},{key:"toggle",value:function(){this.setState(function(e){return{active:!e.active}})}},{key:"select",value:function(e){this.setState({active:!1}),this.props.fetchMaze(e)}},{key:"render",value:function(){var e=this,t=this.props.mazes;return 0===t.length?null:r.a.createElement("div",{className:"dropdown clickable"},r.a.createElement("div",{className:"btn btn-primary dropdown-toggle",onClick:function(){return e.toggle()}},"Select existing maze"),r.a.createElement("div",{className:"dropdown-menu ".concat(this.state.active?"show":"")},t.map(function(t,n){var a=e.props.maze&&e.props.maze.maze_id===t;return r.a.createElement("div",{className:"dropdown-item ".concat(a?"active":""),key:n,onClick:function(){return e.select(t)}},t)})))}}]),t}(a.Component),D=Object(p.b)(function(e){return{mazes:e.mazes,maze:e.maze}},{fetchMazes:function(){return function(e){var t=M();e({type:z,payload:t})}},fetchMaze:A})(x),U=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"create",value:function(){this.props.createMaze({"maze-width":15,"maze-height":25,"maze-player-name":"Fluttershy",difficulty:Math.floor(11*Math.random())})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"maze-creation"},r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.create()}},"Create new maze"))}}]),t}(a.Component),P=Object(p.b)(null,{createMaze:function(e){return function(t){O.create(e).then(function(e){var n=M();n.push(e),h.set("mazes",JSON.stringify(n)),t({type:k,payload:e}),t(A(e))}).catch(function(e){t({type:g,payload:e.response.data})})}}})(U),F=n(89),I=(n(216),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(s.a)(this,Object(l.a)(t).call(this,e))).onKeyDown=n.onKeyDown.bind(Object(F.a)(n)),n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyDown,!1)}},{key:"componentWillUnmount",value:function(){document.addEventListener("keydown",this.onKeyDown,!1)}},{key:"onKeyDown",value:function(e){if(this.props.maze){var t;switch([32,37,38,39,40].indexOf(e.keyCode)>-1&&e.preventDefault(),e.keyCode){case 87:case 38:t="north";break;case 65:case 37:t="west";break;case 83:case 40:t="south";break;case 68:case 39:t="east";break;default:t=null}t&&this.props.movePony(this.props.maze.maze_id,t)}}},{key:"render",value:function(){var e=this.props,t=e.maze,n=e.solution;if(!t)return null;var a=t.size[0],o=t.data.chunk(a),c={};return c[t.pony]="pony",c[t.domokun]="domokun",c[t["end-point"]]="end-point",r.a.createElement("div",{className:"maze"},o.map(function(e,t){return r.a.createElement("div",{className:"maze-row",key:t},e.map(function(e,o){var i=t*a+o,u=c[i]?"object__".concat(c[i]):"",s=n.indexOf(i)>-1?"path":"";return r.a.createElement("div",{className:"maze-cell ".concat(e.join(" ")," ").concat(u," ").concat(s),key:i})}))}))}}]),t}(a.Component)),L=Object(p.b)(function(e){return{maze:e.maze,solution:e.solution}},{movePony:function(e,t){return function(n){O.move(e,t).then(function(){n({type:N,payload:e}),n(A(e))}).catch(function(t){n({type:_,payload:t.response.data}),n(A(e))})}}})(I),T=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return this.props.maze?r.a.createElement("div",{className:"btn btn-primary",onClick:function(){return e.props.solveMaze(e.props.maze)}},"Solve maze"):null}}]),t}(a.Component),R=Object(p.b)(function(e){return{maze:e.maze}},{solveMaze:function(e){return function(t){E.search(e).then(function(e){t({type:C,payload:e})}).catch(function(e){t({type:S,payload:e})})}}})(T),K=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app container"},r.a.createElement("div",{className:"row jumbotron"},r.a.createElement("div",{className:"col align-items-center"},r.a.createElement("h1",null,"Pony Maze"),r.a.createElement("p",null,"Help the pony escape the maze without getting eaten by the domokun! Move using the arrow keys or WASD."),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/Bikstok/PonyMaze",target:"_blank",rel:"noopener noreferrer"},"Source code")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-auto"},r.a.createElement(P,null)),r.a.createElement("div",{className:"col-md-auto"},r.a.createElement(D,null)),r.a.createElement("div",{className:"col-md-auto"},r.a.createElement(R,null))),r.a.createElement("div",{className:"row mt-5"},r.a.createElement("div",{className:"col-md-auto"},r.a.createElement(f,null)))),r.a.createElement("div",{className:"col align-items-center"},r.a.createElement(L,null))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=n(58),H=n(187),J=n(188),W=n(36),B={mazes:[],maze:null,solution:[]};var V=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Z.c,X=Object(Z.d)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return Object(W.a)({},e,{mazes:t.payload});case j:var n=e.solution;return e.maze&&t.payload&&e.maze.maze_id!==t.payload.maze_id&&(n=[]),Object(W.a)({},e,{maze:t.payload,solution:n});case w:return Object(W.a)({},e,{error:t.payload});case k:return Object(W.a)({},e,{error:null,mazes:[t.payload].concat(Object(J.a)(e.mazes))});case g:return Object(W.a)({},e,{error:t.payload});case N:return Object(W.a)({},e,{error:null});case _:return Object(W.a)({},e,{error:t.payload});case C:return Object(W.a)({},e,{solution:t.payload,error:null});case S:return Object(W.a)({},e,{solution:[],error:t.payload});default:return e}},V(Object(Z.a)(H.a)));n(217),n(227);c.a.render(r.a.createElement(p.a,{store:X},r.a.createElement(K,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()}),window.store=X}},[[189,1,2]]]);
//# sourceMappingURL=main.af1cb294.chunk.js.map